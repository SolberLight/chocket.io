(function(){"use strict";var e={9998:function(e,n,t){var o=t(9242),s=t(3396);const r={key:0};function a(e,n,t,o,a,l){const i=(0,s.up)("login-chat-app"),u=(0,s.up)("chat-app");return(0,s.wg)(),(0,s.iD)(s.HY,null,[0===a.page?((0,s.wg)(),(0,s.iD)("h1",r,"chocket.io")):(0,s.kq)("",!0),0===a.page?((0,s.wg)(),(0,s.j4)(i,{key:1,rooms:a.rooms,"room-selected":a.roomSelected,onChangePage:n[0]||(n[0]=e=>l.changePage(e))},null,8,["rooms","room-selected"])):(0,s.kq)("",!0),1===a.page?((0,s.wg)(),(0,s.j4)(u,{key:2,rooms:a.rooms,username:a.username,"room-selected":a.roomSelected},null,8,["rooms","username","room-selected"])):(0,s.kq)("",!0)],64)}var l=t(7139);const i=e=>((0,s.dD)("data-v-e25ae6c6"),e=e(),(0,s.Cn)(),e),u={class:"chocket"},c={class:"room-list"},m={class:"chat"},d={class:"chat-wrapper"},g={id:"message-container",class:"chat-wrapper-inner"},p={class:"message-wrapper"},h={class:"type-message-wrapper"},f=i((()=>(0,s._)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"icon icon-tabler icon-tabler-brand-telegram",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[(0,s._)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s._)("path",{d:"M15 10l-4 4l6 6l4 -16l-18 7l4 2l2 6l3 -4"})],-1))),v=[f];function _(e,n,t,r,a,i){return(0,s.wg)(),(0,s.iD)("div",u,[(0,s._)("div",c,[(0,s._)("ul",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.rooms,((e,n)=>((0,s.wg)(),(0,s.iD)("li",{key:`rooms-${n}`,class:(0,l.C_)(["no-select",{active:e===t.roomSelected}])},(0,l.zw)(e),3)))),128))])]),(0,s._)("div",m,[(0,s._)("div",d,[(0,s._)("div",g,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.messages,((e,n)=>((0,s.wg)(),(0,s.iD)("div",{key:`message-${n}`,class:(0,l.C_)(["message",{mine:e.username===t.username}])},[(0,s._)("div",p,[(0,s._)("b",null,(0,l.zw)(e.username),1),(0,s.Uk)(" "+(0,l.zw)(e.sendAt.toLocaleString())+" ",1),(0,s._)("div",{class:(0,l.C_)(["message-content",{mine:e.username===t.username}])},(0,l.zw)(e.message),3)])],2)))),128))])]),(0,s._)("div",h,[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>a.inputMessage=e),type:"text",placeholder:"Say hello !",onKeydown:n[1]||(n[1]=(0,o.D2)(((...e)=>i.sendMessage&&i.sendMessage(...e)),["enter"]))},null,544),[[o.nr,a.inputMessage]]),(0,s._)("button",{onClick:n[2]||(n[2]=(...e)=>i.sendMessage&&i.sendMessage(...e))},v)])])])}t(7658);var w=t(6265),y=t.n(w);const b="/api/chat";class k{static getMessages(){return new Promise(((e,n)=>{try{y().get(b+"/messages").then((n=>{const t=n.data;e({status:n.status,messages:t.map((e=>({...e,sendAt:new Date(e.sendAt)})))})}))}catch(t){n(t)}}))}static sendMessage(e,n){return y().post(b+"/message",{username:e,message:n})}static deleteMessage(e){return y()["delete"](`${b}/message/${e}`)}}var S=k,M=t(2066),D={name:"ChatApp",data(){return{messages:[],error:null,inputMessage:null,socket:(0,M.ZP)(location.origin)}},props:{roomSelected:{type:String,default:null},rooms:{type:Array,default:()=>[]},username:{type:String,default:null}},mounted(){console.log(location.origin),console.log({NODE_ENV:"production",BASE_URL:"/"}.DATABASE_URL),S.getMessages().then((e=>{200===e.status?(this.messages=e.messages,this.$nextTick((()=>{this.scrollToBottom("message-container")}))):this.error=e.message})),this.socket.on("MESSAGE",(e=>{console.log("received message in front"),this.messages.push(e),this.scrollToBottom("message-container")}))},methods:{sendMessage(){const e={username:this.username,message:this.inputMessage,sendAt:new Date};this.socket.emit("SEND_MESSAGE",e),S.sendMessage(this.username,this.inputMessage),this.scrollToBottom("message-container"),this.inputMessage=null},scrollToBottom(e){const n=document.getElementById(e);n.scrollTop=n.scrollHeight}}},A=t(89);const C=(0,A.Z)(D,[["render",_],["__scopeId","data-v-e25ae6c6"]]);var j=C;const O=e=>((0,s.dD)("data-v-641cb7e0"),e=e(),(0,s.Cn)(),e),E={class:"chocket"},T={class:"login"},x=O((()=>(0,s._)("label",{for:"username"},"Username",-1))),P=O((()=>(0,s._)("br",null,null,-1))),B=O((()=>(0,s._)("br",null,null,-1))),U=O((()=>(0,s._)("label",{for:"rooms"},"Room",-1))),$=O((()=>(0,s._)("br",null,null,-1))),z=O((()=>(0,s._)("option",{value:null},"--Select a room--",-1))),H=["value"],L={class:"button-container"};function I(e,n,t,r,a,i){return(0,s.wg)(),(0,s.iD)("div",E,[(0,s._)("div",T,[(0,s._)("div",null,[x,P,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>a.username=e),id:"username",type:"text",placeholder:"John Do"},null,512),[[o.nr,a.username]])]),B,(0,s._)("div",null,[U,$,(0,s.wy)((0,s._)("select",{"onUpdate:modelValue":n[1]||(n[1]=e=>a.roomSelected=e),id:"rooms",name:"rooms"},[z,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.rooms,((e,n)=>((0,s.wg)(),(0,s.iD)("option",{key:`rooms-${n}`,value:e},(0,l.zw)(e),9,H)))),128))],512),[[o.bM,a.roomSelected]])]),(0,s._)("div",L,[(0,s._)("button",{onClick:n[2]||(n[2]=(...e)=>i.join&&i.join(...e))}," Join ")])])])}var K={name:"LoginChatApp",data(){return{roomSelected:null,username:null}},props:{rooms:{type:Array,default:()=>[]}},methods:{join(){this.username&&this.rooms.includes(this.roomSelected)&&this.$emit("change-page",{page:1,room:this.roomSelected,username:this.username})}}};const V=(0,A.Z)(K,[["render",I],["__scopeId","data-v-641cb7e0"]]);var Y=V,Z={name:"App",components:{ChatApp:j,LoginChatApp:Y},data(){return{page:0,rooms:["General"],roomSelected:null,username:null}},methods:{changePage(e){this.page=e.page,this.roomSelected=e.room,this.username=e.username}}};const q=(0,A.Z)(Z,[["render",a],["__scopeId","data-v-4494d81b"]]);var G=q;(0,o.ri)(G).mount("#app")}},n={};function t(o){var s=n[o];if(void 0!==s)return s.exports;var r=n[o]={exports:{}};return e[o](r,r.exports,t),r.exports}t.m=e,function(){var e=[];t.O=function(n,o,s,r){if(!o){var a=1/0;for(c=0;c<e.length;c++){o=e[c][0],s=e[c][1],r=e[c][2];for(var l=!0,i=0;i<o.length;i++)(!1&r||a>=r)&&Object.keys(t.O).every((function(e){return t.O[e](o[i])}))?o.splice(i--,1):(l=!1,r<a&&(a=r));if(l){e.splice(c--,1);var u=s();void 0!==u&&(n=u)}}return n}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[o,s,r]}}(),function(){t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,{a:n}),n}}(),function(){t.d=function(e,n){for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};t.O.j=function(n){return 0===e[n]};var n=function(n,o){var s,r,a=o[0],l=o[1],i=o[2],u=0;if(a.some((function(n){return 0!==e[n]}))){for(s in l)t.o(l,s)&&(t.m[s]=l[s]);if(i)var c=i(t)}for(n&&n(o);u<a.length;u++)r=a[u],t.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return t.O(c)},o=self["webpackChunkclient"]=self["webpackChunkclient"]||[];o.forEach(n.bind(null,0)),o.push=n.bind(null,o.push.bind(o))}();var o=t.O(void 0,[998],(function(){return t(9998)}));o=t.O(o)})();
//# sourceMappingURL=app.0a0ff9df.js.map